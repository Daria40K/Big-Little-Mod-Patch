<?xml version='1.0' encoding='utf-8'?>
<Patch>
    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Rimstro</li>
        </mods>
        <match Class="PatchOperationSequence">
            <success>Always</success>
            <operations>
                <li Class="PatchOperationConditional">
                    <xpath>Defs/ThingDef[defName="RS_Microwave"][not(comps)]</xpath>
                    <match Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="RS_Microwave"]</xpath>
                        <value>
                            <comps>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </comps>
                        </value>
                    </match>
                    <nomatch Class="PatchOperationConditional">
                        <xpath>Defs/ThingDef[defName="RS_Microwave"]/comps[not(li[@Class="CompProperties_AffectedByFacilities"])]</xpath>
                        <match Class="PatchOperationAdd">
                            <xpath>Defs/ThingDef[defName="RS_Microwave"]/comps</xpath>
                            <value>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </value>
                        </match>
                    </nomatch>
                </li>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="RS_Blender"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
                    <value>
                        <li MayRequire="daylight.wbsmorelinkf">Link_BreweryGoods</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_BreweryBoost</li>
                        <li MayRequire="4loris4.morelinkables">KitchenCupboard</li>
                        <li MayRequire="van.datools">DA_MixingBarrel</li>
                        <li MayRequire="dankpyon.medieval.overhaul">DankPyon_RusticCookingTools</li>
                        <li MayRequire="akn.decorations">AKN_MotivatingPlush</li>
                        <li MayRequire="lat.rimstro">RS_Counter</li>
                        <li MayRequire="lat.rimstro">RS_KitchenHood</li>
                        <li MayRequire="lat.rimstro">RS_TopShelf</li>
                        <li MayRequire="lat.rimstro">RS_stove</li>
                        <li MayRequire="hobbes.bamba.evenmorelinkables16">HobbesLink_ConveyorBelt</li>
                        <li MayRequire="hobbes.bamba.evenmorelinkables16">HobbesLink_RobotAssistant</li>
                        <li MayRequire="hobbes.bamba.evenmorelinkables16">HobbesLink_Still</li>
                        <li MayRequire="hobbes.bamba.evenmorelinkables16">HobbesLink_Rotovape</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_Sink</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_KitchenCupboard_A</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_KitchenCupboard_B</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_KitchenCupboard_C</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_UniversalCabinet</li>
                        <li MayRequire="lyn.nto">LYN_Nanocabinet</li>
                    </value>
                </li>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="RS_Doma"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
                    <value>
                        <li MayRequire="roo.antyracemod">AT_Chart</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_ButcherGoods</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_ButcherBoost</li>
                        <li MayRequire="oskarpotocki.vfe.medieval2">VFEM2_CleaverRack</li>
                        <li MayRequire="oskarpotocki.vfe.medieval2">VFEM2_CarvingBoard</li>
                        <li MayRequire="4loris4.morelinkables">KitchenCupboard</li>
                        <li MayRequire="van.datools">DA_ButcheringTools</li>
                        <li MayRequire="dankpyon.medieval.overhaul">DankPyon_RusticCookingTools</li>
                        <li MayRequire="akn.decorations">AKN_MotivatingPlush</li>
                        <li MayRequire="lat.rimstro">RS_Counter</li>
                        <li MayRequire="lat.rimstro">RS_KitchenHood</li>
                        <li MayRequire="lat.rimstro">RS_TopShelf</li>
                        <li MayRequire="lat.rimstro">RS_stove</li>
                        <li MayRequire="hobbes.bamba.evenmorelinkables16">HobbesLink_ConveyorBelt</li>
                        <li MayRequire="hobbes.bamba.evenmorelinkables16">HobbesLink_RobotAssistant</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_Sink</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_ButcherShelf</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_KitchenCupboard_A</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_KitchenCupboard_B</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_KitchenCupboard_C</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_UniversalCabinet</li>
                        <li MayRequire="lyn.nto">LYN_Nanocabinet</li>
                    </value>
                </li>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="RS_Pot" or defName="RS_Microwave" or defName="RS_stove"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
                    <value>
                        <li MayRequire="solaris.furniturebase">GL_Cupboard</li>
                        <li MayRequire="solaris.furniturebase">GL_TablewareShelf</li>
                        <li MayRequire="gloomy.furniture.continued">GL_Cupboard</li>
                        <li MayRequire="gloomy.furniture.continued">GL_TablewareShelf</li>
                        <li MayRequire="dismarzero.vgp.vgpgardengourmet">CookingTools</li>
                        <li MayRequire="limetreesnake.furnishing">LTS_Sink</li>
                        <li MayRequire="limetreesnake.furnishing">LTS_Fridge</li>
                        <li MayRequire="vanillaexpanded.vfeproduction">VFE_KitchenSinkCabinet</li>
                        <li MayRequire="zal.morearchotechgarbage">ArchoCookingAssistant</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_KitchenGoods</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_KitchenBoost</li>
                        <li MayRequire="4loris4.morelinkables">KitchenCupboard</li>
                        <li MayRequire="dankpyon.medieval.overhaul">DankPyon_RusticCookingTools</li>
                        <li MayRequire="dankpyon.medieval.overhaul">DankPyon_TableBaking</li>
                        <li MayRequire="akn.decorations">AKN_MotivatingPlush</li>
                        <li MayRequire="lat.rimstro">RS_Counter</li>
                        <li MayRequire="lat.rimstro">RS_KitchenHood</li>
                        <li MayRequire="lat.rimstro">RS_TopShelf</li>
                        <li MayRequire="lat.rimstro">RS_stove</li>
                        <li MayRequire="lat.rimstro">RS_stove</li>
                        <li MayRequire="hobbes.bamba.evenmorelinkables16">HobbesLink_IndustrialOven</li>
                        <li MayRequire="hobbes.bamba.evenmorelinkables16">HobbesLink_ConveyorBelt</li>
                        <li MayRequire="hobbes.bamba.evenmorelinkables16">HobbesLink_RobotAssistant</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_Sink</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_KitchenCupboard_A</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_KitchenCupboard_B</li>
                        <li MayRequire="zal.gloomyextrakitchen">SM_KitchenCupboard_C</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_UniversalCabinet</li>
                        <li MayRequire="lyn.nto">LYN_Nanocabinet</li>
                    </value>
                </li>
            </operations>
        </match>
    </Operation>
</Patch>