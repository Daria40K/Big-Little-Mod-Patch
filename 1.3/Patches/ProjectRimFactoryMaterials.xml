<?xml version='1.0' encoding='utf-8'?>
<Patch>
    <Operation Class="PatchOperationFindMod">
        <mods>
            <li>Project RimFactory - Materials</li>
        </mods>
        <match Class="PatchOperationSequence">
            <operations>
                <li Class="PatchOperationConditional">
                    <xpath>Defs/ThingDef[defName="PRF_FueledStoneSmelter"][not(comps)]</xpath>
                    <match Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="PRF_FueledStoneSmelter"]</xpath>
                        <value>
                            <comps>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </comps>
                        </value>
                    </match>
                    <nomatch Class="PatchOperationConditional">
                        <xpath>Defs/ThingDef[defName="PRF_FueledStoneSmelter"]/comps[not(li[@Class="CompProperties_AffectedByFacilities"])]</xpath>
                        <match Class="PatchOperationAdd">
                            <xpath>Defs/ThingDef[defName="PRF_FueledStoneSmelter"]/comps</xpath>
                            <value>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </value>
                        </match>
                    </nomatch>
                </li>
                <li Class="PatchOperationConditional">
                    <xpath>Defs/ThingDef[defName="PRF_FurnaceIV"][not(comps)]</xpath>
                    <match Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="PRF_FurnaceIV"]</xpath>
                        <value>
                            <comps>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </comps>
                        </value>
                    </match>
                    <nomatch Class="PatchOperationConditional">
                        <xpath>Defs/ThingDef[defName="PRF_FurnaceIV"]/comps[not(li[@Class="CompProperties_AffectedByFacilities"])]</xpath>
                        <match Class="PatchOperationAdd">
                            <xpath>Defs/ThingDef[defName="PRF_FurnaceIV"]/comps</xpath>
                            <value>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </value>
                        </match>
                    </nomatch>
                </li>
                <li Class="PatchOperationConditional">
                    <xpath>Defs/ThingDef[defName="PRF_T2_Stonecutter"][not(comps)]</xpath>
                    <match Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="PRF_T2_Stonecutter"]</xpath>
                        <value>
                            <comps>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </comps>
                        </value>
                    </match>
                    <nomatch Class="PatchOperationConditional">
                        <xpath>Defs/ThingDef[defName="PRF_T2_Stonecutter"]/comps[not(li[@Class="CompProperties_AffectedByFacilities"])]</xpath>
                        <match Class="PatchOperationAdd">
                            <xpath>Defs/ThingDef[defName="PRF_T2_Stonecutter"]/comps</xpath>
                            <value>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </value>
                        </match>
                    </nomatch>
                </li>
                <li Class="PatchOperationConditional">
                    <xpath>Defs/ThingDef[defName="PRF_MaterialsRefinery"][not(comps)]</xpath>
                    <match Class="PatchOperationAdd">
                        <xpath>Defs/ThingDef[defName="PRF_MaterialsRefinery"]</xpath>
                        <value>
                            <comps>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </comps>
                        </value>
                    </match>
                    <nomatch Class="PatchOperationConditional">
                        <xpath>Defs/ThingDef[defName="PRF_MaterialsRefinery"]/comps[not(li[@Class="CompProperties_AffectedByFacilities"])]</xpath>
                        <match Class="PatchOperationAdd">
                            <xpath>Defs/ThingDef[defName="PRF_MaterialsRefinery"]/comps</xpath>
                            <value>
                                <li Class="CompProperties_AffectedByFacilities">
                                    <linkableFacilities />
                                </li>
                            </value>
                        </match>
                    </nomatch>
                </li>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="PRF_FueledStoneSmelter" or defName="PRF_FurnaceIV"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
                    <value>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_II</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_Unobtainer_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_III</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_II</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_III</li>
                        <li MayRequire="mlie.uncolony">SadjuukShaper</li>
                        <li MayRequire="mlie.uncolony">SadjuukGrinding</li>
                        <li MayRequire="mlie.uncolony">SadjuukWeldingRobot</li>
                        <li MayRequire="mlie.uncolony">SadjuukLathe</li>
                        <li MayRequire="mlie.uncolony">SadjuukMilling</li>
                        <li MayRequire="mlie.uncolony">SadjuukAssemblyRobot</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_SmelterGoods</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_SmelterBoost</li>
                        <li MayRequire="elstrages.cyberneticstorm">CS_ReAnalyser</li>
                        <li MayRequire="ucp.tabletopdecorations">ucp_toolbox</li>
                        <li MayRequire="ucp.tabletopdecorations">ucp_hammer</li>
                        <li MayRequire="ucp.tabletopdecorations">ucp_tongs</li>
                        <li MayRequire="ucp.tabletopdecorations">ucp_ballpeen</li>
                        <li MayRequire="twink.vaultfurniture">vtcompter</li>
                        <li MayRequire="twink.vaultfurniture">Vt_server</li>
                        <li MayRequire="arcjc007.wallstuff">WallToolBoard</li>
                        <li MayRequire="neronix17.outland.core">Outland_Grindstone</li>
                        <li MayRequire="qx.astramilitarum">ManCogitator</li>
                        <li MayRequire="mlie.tacticalchargedgear">TCToolCabinet</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_UniversalCabinet</li>
                        <li MayRequire="lyn.nto">LYN_Nanocabinet</li>
                    </value>
                </li>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="PRF_T2_Stonecutter"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
                    <value>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_II</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_Unobtainer_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_III</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_II</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_III</li>
                        <li MayRequire="mlie.uncolony">SadjuukShaper</li>
                        <li MayRequire="mlie.uncolony">SadjuukGrinding</li>
                        <li MayRequire="mlie.uncolony">SadjuukWeldingRobot</li>
                        <li MayRequire="mlie.uncolony">SadjuukLathe</li>
                        <li MayRequire="mlie.uncolony">SadjuukMilling</li>
                        <li MayRequire="mlie.uncolony">SadjuukAssemblyRobot</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_StoneCutterGoods</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_StoneCutterBoost</li>
                        <li MayRequire="elstrages.cyberneticstorm">CS_ReAnalyser</li>
                        <li MayRequire="ucp.tabletopdecorations">ucp_toolbox</li>
                        <li MayRequire="twink.vaultfurniture">vtcompter</li>
                        <li MayRequire="twink.vaultfurniture">Vt_server</li>
                        <li MayRequire="arcjc007.wallstuff">WallToolBoard</li>
                        <li MayRequire="neronix17.outland.core">Outland_Grindstone</li>
                        <li MayRequire="qx.astramilitarum">ManCogitator</li>
                        <li MayRequire="mlie.tacticalchargedgear">TCToolCabinet</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_UniversalCabinet</li>
                        <li MayRequire="lyn.nto">LYN_Nanocabinet</li>
                    </value>
                </li>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="PRF_GrindStone"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
                    <value>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_II</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_Unobtainer_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_III</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_II</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_III</li>
                        <li MayRequire="mlie.uncolony">SadjuukShaper</li>
                        <li MayRequire="mlie.uncolony">SadjuukGrinding</li>
                        <li MayRequire="mlie.uncolony">SadjuukWeldingRobot</li>
                        <li MayRequire="mlie.uncolony">SadjuukLathe</li>
                        <li MayRequire="mlie.uncolony">SadjuukMilling</li>
                        <li MayRequire="mlie.uncolony">SadjuukAssemblyRobot</li>
                        <li MayRequire="elstrages.cyberneticstorm">CS_ReAnalyser</li>
                        <li MayRequire="ucp.tabletopdecorations">ucp_toolbox</li>
                        <li MayRequire="ucp.tabletopdecorations">ucp_screwdrivers</li>
                        <li MayRequire="twink.vaultfurniture">vtcompter</li>
                        <li MayRequire="twink.vaultfurniture">Vt_server</li>
                        <li MayRequire="arcjc007.wallstuff">WallToolBoard</li>
                        <li MayRequire="neronix17.outland.core">Outland_Grindstone</li>
                        <li MayRequire="qx.astramilitarum">ManCogitator</li>
                        <li MayRequire="mlie.tacticalchargedgear">TCToolCabinet</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_UniversalCabinet</li>
                        <li MayRequire="lyn.nto">LYN_Nanocabinet</li>
                    </value>
                </li>
                <li Class="PatchOperationAdd">
                    <xpath>Defs/ThingDef[defName="PRF_MaterialsRefinery"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
                    <value>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_II</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_Unobtainer_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicDrawer_III</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_I</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_II</li>
                        <li MayRequire="explodoboy.snsambitioncosmic">SNS_Linkable_CosmicCall_III</li>
                        <li MayRequire="mlie.uncolony">SadjuukShaper</li>
                        <li MayRequire="mlie.uncolony">SadjuukGrinding</li>
                        <li MayRequire="mlie.uncolony">SadjuukWeldingRobot</li>
                        <li MayRequire="mlie.uncolony">SadjuukLathe</li>
                        <li MayRequire="mlie.uncolony">SadjuukMilling</li>
                        <li MayRequire="mlie.uncolony">SadjuukAssemblyRobot</li>
                        <li MayRequire="mlie.uncolonyvanilla">SadjuukRefineryUpgradeA</li>
                        <li MayRequire="mlie.uncolonyvanilla">SadjuukRefineryUpgradeB</li>
                        <li MayRequire="mlie.uncolonyvanilla">SadjuukRefineryUpgradeC</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_RefineryBoost</li>
                        <li MayRequire="elstrages.cyberneticstorm">CS_ReAnalyser</li>
                        <li MayRequire="twink.vaultfurniture">vtcompter</li>
                        <li MayRequire="twink.vaultfurniture">Vt_server</li>
                        <li MayRequire="arcjc007.wallstuff">WallToolBoard</li>
                        <li MayRequire="neronix17.outland.core">Outland_Grindstone</li>
                        <li MayRequire="qx.astramilitarum">ManCogitator</li>
                        <li MayRequire="mlie.tacticalchargedgear">TCToolCabinet</li>
                        <li MayRequire="daylight.wbsmorelinkf">Link_UniversalCabinet</li>
                        <li MayRequire="lyn.nto">LYN_Nanocabinet</li>
                    </value>
                </li>
            </operations>
        </match>
    </Operation>
</Patch>