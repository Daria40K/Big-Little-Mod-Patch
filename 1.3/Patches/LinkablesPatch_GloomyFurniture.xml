<?xml version="1.0" encoding="utf-8"?>
<Patch>
	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>GloomyFurniture</li>
		</mods>

		<match Class="PatchOperationSequence">
			<success>Always</success>
			<operations>
				<li Class="PatchOperationInsert">
					<xpath>Defs/ThingDef/comps/li/linkableFacilities/li[text()="Dresser"]</xpath>
					<value>
						<li>RGK_Dresser</li><!-- GloomyFurniture -->
						<li>WardrobeA</li><!-- GloomyFurniture -->
                        <li>WardrobeB</li><!-- GloomyFurniture -->
                        <li>GL_Teddy</li><!-- GloomyFurniture -->
					</value>
				</li>

				<li Class="PatchOperationInsert">
					<xpath>Defs/ThingDef/comps/li/linkableFacilities/li[text()="EndTable"]</xpath>
					<value>
						<li>RGK_EndTable</li><!-- GloomyFurniture -->
			            <li>RGK_EndTableWithLamp</li><!-- GloomyFurniture -->
			            <li>RGK_EndTableWithLampE</li><!-- GloomyFurniture -->
					</value>
				</li>

				<li Class="PatchOperationInsert">
                    <xpath>Defs/ThingDef/comps/li/linkableFacilities/li[text()="MultiAnalyzer"]</xpath>
                    <value>
                        <li>GL_Bookshelf</li><!-- GloomyFurniture -->
                    </value>
                </li>

				<li Class="PatchOperationAdd">
					<xpath>/Defs/ThingDef[
						defName = "ElectricStove" or 
						defName = "FueledStove"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
					<value>
						<li>GL_Cupboard</li><!-- GloomyFurniture -->
						<li>GL_TablewareShelf</li><!-- GloomyFurniture -->
					</value>
				</li>

				<!-- Ideology [Official DLC] -->
				<li Class="PatchOperationFindMod">
					<mods>
						<li>Ideology</li>
					</mods>
					<match Class="PatchOperationSequence">
						<success>Always</success>
						<operations>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/ThingDef[
									defName = "RGK_bedSingle" or 
									defName = "RGK_bedSingleB" or 
									defName = "RGK_bedDouble" or 
									defName = "RGK_bedDoubleB" or 
									defName = "GL_ClassyDoubleBed"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
								<value>
									<li>SleepAccelerator</li><!-- Ideology [Official DLC] -->
								</value>
							</li>
						</operations>
					</match>
				</li>

				<!-- Medieval Overhaul -->
				<li Class="PatchOperationFindMod">
					<mods>
						<li>Medieval Overhaul</li>
					</mods>
					<match Class="PatchOperationSequence">
						<success>Always</success>
						<operations>
							<li Class="PatchOperationAdd">
								<xpath>/Defs/ThingDef[
									defName = "DankPyon_Grill" or 
									defName = "DankPyon_RusticCookingTable" or 
									defName = "DankPyon_StoneOven" or 
									defName = "DankPyon_StewPot" or 
									defName = "DankPyon_Millstone"]/comps/li[@Class="CompProperties_AffectedByFacilities"]/linkableFacilities</xpath>
								<value>
									<li>GL_Cupboard</li><!-- GloomyFurniture -->
									<li>GL_TablewareShelf</li><!-- GloomyFurniture -->
								</value>
							</li>
						</operations>
					</match>
				</li>
			</operations>
		</match>
	</Operation>
</Patch>